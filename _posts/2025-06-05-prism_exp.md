---
layout:     post
title:      "The Prism Project"
subtitle:   "Cause I don't trust my smart plugs anymore"
date:       2025-06-05 20:27:00
author:     "Mac"
header-img: "img/in-post/prism.jpg"
catalog: true
tags:
    - Networking
    - Internet Of Things
    - Cybersecurity
---

> "Walking Into a Security Nightmare"

---

The first week of my summer internship was painfully dull. "General IT assessment tasks" basically meant busywork nobody else wanted—cataloging equipment, checking inventory numbers, the kind of mind-numbing work designed to keep interns busy and out of the way.

But then, one afternoon during my lunch break, curiosity got the better of me. I pulled out my laptop, connected to the "visitor" wifi, and ran a quick nmap scan of the local network. Nothing fancy—just some basic reconnaissance to see what was actually running on this "secure" government network. Then I cross-referenced a few interesting findings with a search engine for internet-connected devices.

I saw it all...

Two hundred devices across three floors. Printers with firmware from 2018 that hadn't seen a security patch since the Obama administration. Security cameras still running Telnet—a protocol so insecure it might as well broadcast passwords in neon signs. Environmental sensors cheerfully broadcasting their configuration data over UPnP to anyone who cared to listen. Air quality monitors with web interfaces protected by "admin/admin" credentials.

Almost 60% of everything I found was wide open—default passwords that took thirty seconds to find online, firmware so outdated that exploit code was readily available on GitHub, management interfaces exposed to the internet like digital welcome mats for attackers.

I remember sitting in that sterile government cafeteria, staring at the scrolling results on my screen, I tell myself; *If I can map out this entire network in 30 minutes using generic tools, what could an actual motivated attacker with real resources and malicious intent accomplish?*

That was the moment when the work stopped being boring.

## **A Reality Check**

When I brought my findings to my senior, I expected him to freak out. I expected meetings, patch schedules, maybe even some kind of lockdown. Instead, what he told me fundamentally changed how I think about security:

*"This is a supply chain problem,"* he said, barely looking up from his coffee. *"These devices are cheap, convenient, and they do exactly what they're supposed to do. Nobody buys IoT sensors for their security posture. They buy them because they work out of the box and cost fifty rupees instead of five thousand."*

He gestured around the office. *"Manufacturers build what customers buy, and customers buy based on features and price, not security architecture. Real security costs money, requires expertise, and makes devices more complex. The market has spoken, and it doesn't want to pay for security."*

I looked around the place with a new perspective. Every device here was working perfectly for its intended purpose—printing documents, monitoring temperature, tracking occupancy, managing building systems. But they were also doing a lot more than that, quietly broadcasting their presence, accepting connections, running web servers, and creating attack vectors that nobody had planned for or secured.

That's when it hit me: this wasn't just a technical problem that could be solved with better patches or smarter configurations. This was an economic problem. And millions of vulnerable devices are already been permanently cemented into critical infrastructure.

## **Down the Rabbit Hole**

MY ADHD couldn't let it go. Nights and weekends, I dove headfirst down the IoT security rabbit hole, consuming everything I could find about attack methodologies, defense strategies, and the economics of cybercrime.

I studied the Mirai botnet source code; which is all [publicly available on gitHub btw](https://github.com/0x27/linux.mirai), it's a masterpiece in exploitation at scale. I traced through the MITRE ATT&CK framework for industrial control systems, learning how attackers move from initial IoT compromise to full network penetration. I read academic papers on network segmentation, device monitoring, and wholesale infrastructure replacement strategies.

The worst part? It was all disturbingly easy. Mirai's fundamental attack pattern was still completely valid nine years after its initial release:

1. Scan the internet for devices
2. Try a list of default credentials
3. Drop malware payload
4. Repeat until you control millions of devices

The defenses I found in the literature fell into predictable categories: network segmentation (expensive, complex, often incomplete), device replacement programs (financially impossible for most organizations), cloud-based monitoring solutions (still vulnerable to direct attack), and authentication improvements (useless for devices that can't be updated).

Every solution had the same fundamental flaw: they were either prohibitively expensive, technically impossible for legacy devices, or still left critical gaps that determined attackers could exploit.

I started to feel like the entire system was rigged against defenders. Until one night, deep into a caffeine-fueled research binge at 2 AM, I stumbled across some fascinating research on polymorphic malware—sophisticated code that changes its signature and structure with every infection to dodge detection systems.

And suddenly my brain flipped the script entirely.

*What if we used polymorphism not to attack, but to defend?*

## **The Breakthrough Moment**

The concept is, instead of trying to secure individual IoT devices—which was clearly impossible—what if we made every device invisible and unique from an attacker's perspective?

Imagine this: every vulnerable IoT device doesn't connect directly to the internet, but instead connects through its own personal, polymorphic security gateway. A small, dedicated computer—say, a Raspberry Pi Zero—sitting between the device and the outside world, acting as a sophisticated proxy and bodyguard.

To the IoT device, everything looks completely normal. It connects to what appears to be regular WiFi, sends its data to what looks like normal internet endpoints, receives firmware updates through what seems like standard channels.

But to the outside world, every single deployment looks completely different. Same security logic, same protective rules, but entirely different network fingerprints, different response patterns, different apparent vulnerabilities, different attack surfaces.

Which means mass exploitation—the very foundation that makes botnets profitable—suddenly breaks down completely. Attackers can't develop a single exploit that works across thousands of identical targets. They'd have to research and attack devices one by one, burning time, money, and resources with every individual attempt.

Suddenly, inherently insecure devices stop being attractive targets for large-scale attackers. The economics of cybercrime shift fundamentally when easy, scalable attacks become difficult and unprofitable.

## **From Theory to PRISM**

That "what if" moment eventually became a project I called PRISM—**P**olymorphic **R**esponse for **I**oT **S**ecurity **M**anagement. The initial prototype used Raspberry Pi Zero 2W units as dedicated security gateways that would:

- Intercept all device traffic transparently using iptables and custom routing
- Apply polymorphically unique firewall configurations for each deployment
- Proxy all communications through encrypted TLS 1.3 tunnels to hide device identity
- Implement selective transparency to allow legitimate OTA updates while blocking suspicious traffic
- Generate completely different network fingerprints while maintaining identical security policies

The idea wasn't just about improving security—it was about changing the fundamental economics of IoT attacks. When attacks go from cheap and infinitely scalable to slow, custom, and unprofitable, the entire threat landscape shifts in favor of defenders.

## **The Bigger Picture**
We don't have to wait for manufacturers to suddenly start prioritizing security over profit margins. We don't have to rip out millions of legacy devices that are working perfectly well for their intended purposes. We don't have to accept that IoT security is fundamentally broken and unfixable.

We just need to make inherently insecure devices irrelevant to attackers.

### **Edit**
PRISM was supposed to be that first step. But as I learned while actually trying to build it, sometimes the most elegant theoretical solutions aren't the most practical ones. The complexity of polymorphic defense mechanisms, the computational overhead, the management challenges—they all added up to a system that was intellectually beautiful but practically unwieldy.